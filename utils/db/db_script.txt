CREATE TABLE "cliente" (
	"id" serial NOT NULL,
	"nombre" VARCHAR(100) NOT NULL,
	"apellido" VARCHAR(100) NOT NULL,
	"nro_documento" VARCHAR(50) NOT NULL,
	"tipo_documento_fk" integer NOT NULL,
	"nacionalidad_fk" integer NOT NULL,
	"email" VARCHAR(100) NOT NULL,
	"telefono" VARCHAR(100) NOT NULL,
	"fecha_nacimiento" DATE NOT NULL,
	CONSTRAINT "cliente_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "tipo_documento" (
	"id" serial NOT NULL,
	"descripcion" VARCHAR(100) NOT NULL,
	CONSTRAINT "tipo_documento_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "nacionalidad" (
	"id" serial NOT NULL,
	"descripcion" VARCHAR(100) NOT NULL,
	CONSTRAINT "nacionalidad_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "concepto_puntos" (
	"id" serial NOT NULL,
	"descripcion" VARCHAR(100) NOT NULL,
	"puntos_requeridos" integer NOT NULL,
	CONSTRAINT "concepto_puntos_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "puntos" (
	"id_puntos" serial NOT NULL,
	"lim_inf" integer NOT NULL,
	"lim_sup" integer NOT NULL,
	"monto_equivalencia" integer NOT NULL,
	CONSTRAINT "puntos_pk" PRIMARY KEY ("id_puntos")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "vencimiento_puntos" (
	"id" serial NOT NULL,
	"fecha_inicio" DATE NOT NULL,
	"fecha_fin" DATE NOT NULL,
	"dias_duracion" integer NOT NULL,
	CONSTRAINT "vencimiento_puntos_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "bolsa_puntos" (
	"id" serial NOT NULL,
	"id_cliente" integer NOT NULL,
	"fecha_asignacion" DATE NOT NULL,
	"fecha_caducidad" DATE NOT NULL,
	"puntaje_asignado" integer NOT NULL,
	"puntaje_utilizado" integer NOT NULL,
	"saldo_puntos" integer NOT NULL,
	"monto_operacion" integer NOT NULL,
	CONSTRAINT "bolsa_puntos_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "cabecera_uso_puntos" (
	"id" serial NOT NULL,
	"id_cliente" integer NOT NULL,
	"puntaje_utilizado" integer NOT NULL,
	"fecha" DATE NOT NULL,
	"id_concepto_uso_puntos" integer NOT NULL,
	CONSTRAINT "cabecera_uso_puntos_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "detalle_uso_puntos" (
	"id" serial NOT NULL,
	"id_cabecera" integer NOT NULL,
	"puntaje_utilizado" integer NOT NULL,
	"id_bolsa_puntos" integer NOT NULL,
	CONSTRAINT "detalle_uso_puntos_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



ALTER TABLE "cliente" ADD CONSTRAINT "cliente_fk0" FOREIGN KEY ("tipo_documento_fk") REFERENCES "tipo_documento"("id");
ALTER TABLE "cliente" ADD CONSTRAINT "cliente_fk1" FOREIGN KEY ("nacionalidad_fk") REFERENCES "nacionalidad"("id");






ALTER TABLE "bolsa_puntos" ADD CONSTRAINT "bolsa_puntos_fk0" FOREIGN KEY ("id_cliente") REFERENCES "cliente"("id");

ALTER TABLE "cabecera_uso_puntos" ADD CONSTRAINT "cabecera_uso_puntos_fk0" FOREIGN KEY ("id_cliente") REFERENCES "cliente"("id");
ALTER TABLE "cabecera_uso_puntos" ADD CONSTRAINT "cabecera_uso_puntos_fk1" FOREIGN KEY ("id_concepto_uso_puntos") REFERENCES "concepto_puntos"("id");

ALTER TABLE "detalle_uso_puntos" ADD CONSTRAINT "detalle_uso_puntos_fk0" FOREIGN KEY ("id_cabecera") REFERENCES "cabecera_uso_puntos"("id");
ALTER TABLE "detalle_uso_puntos" ADD CONSTRAINT "detalle_uso_puntos_fk1" FOREIGN KEY ("id_bolsa_puntos") REFERENCES "bolsa_puntos"("id");
